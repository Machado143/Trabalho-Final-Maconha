services:
  # ============================================
  # WEB SERVICE - APLICAÇÃO DJANGO
  # ============================================
  - type: web
    name: pai-do-verde
    env: python
    region: oregon  # ou 'ohio', 'frankfurt' (mais próximo do Brasil)
    
    # Comandos
    buildCommand: chmod +x build.sh && ./build.sh
    startCommand: gunicorn trabalho_final.wsgi:application --workers 2 --timeout 120 --log-level info
    
    # Plano (free = grátis)
    plan: free
    
    # Variáveis de Ambiente
    envVars:
      - key: PYTHON_VERSION
        value: 3.10.12
      
      - key: DATABASE_URL
        fromDatabase:
          name: pai-do-verde-db
          property: connectionString
      
      - key: SECRET_KEY
        generateValue: true  # Gera automaticamente
      
      - key: DEBUG
        value: False
      
      - key: WEB_CONCURRENCY
        value: 2  # Workers do Gunicorn
      
      # ⚠️ IMPORTANTE: Configure estas no painel do Render
      # (não coloque valores secretos aqui no código)
      - key: CLOUDINARY_CLOUD_NAME
        sync: false  # Você precisa adicionar manualmente
      
      - key: CLOUDINARY_API_KEY
        sync: false
      
      - key: CLOUDINARY_API_SECRET
        sync: false

# ============================================
# BANCO DE DADOS POSTGRESQL
# ============================================
databases:
  - name: pai-do-verde-db
    databaseName: pai_do_verde
    user: pai_do_verde_user
    region: oregon  # Mesma região do web service
    plan: free  # PostgreSQL grátis (90 dias de retenção)